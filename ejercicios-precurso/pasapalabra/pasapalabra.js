const questions = [[{answer: "Abducir",
                    question: "Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien",},
                    {answer: "Asno",
                    question: "Animal, como de metro y medio de altura, de orejas largas, muy sufrido y que se emplea como caballería, como bestia de carga y también de tiro.",},
                    {answer: "Alien",
                    question: "Película de 1979 en la que se cuela un pasajero de más en la U.S.C.S.S. Nostromo.",},],
                   [{answer: "Bingo",
                    question: "Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso",},
                    {answer: "Ballena",
                    question: "Cetáceo, el mayor de todos los animales conocidos, que llega a crecer hasta más de 30 m de longitud.",},
                    {answer: "Barbarella",
                    question: "Película de 1968 en la que a una aventurera, de nombre homónimo, se le encomienda la búsqueda del científico loco, el doctor Durand-Durand.",},],
                   [{answer: "Churumbel",
                    question: "Niño, crío, bebé",},
                    {answer: "Cebra",
                    question: "Animal, parecido al asno, de pelo blanco amarillento, con listas transversales pardas o negras.",},
                    {answer: "Contact",
                    question: "Película de 1997, adaptación de la novela con el mismo nombre de Carl Sagan, en la que detectan una señal acústica que repite una secuencia de números primos con procedencia de Vega.",},],
                   [{answer: "Diarrea",
                    question: "Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida",},
                    {answer: "Dromedario",
                    question: "Artiodáctilo rumiante con una giba adiposa en el dorso.",},
                    {answer: "Dune",
                    question: "Película de 1984, basada en la novela hómonima de Frank Herbert, en la que la familia Atreides explota el desértico planeta Arrakis.",},],
                   [{answer: "Ectoplasma",
                    question: "Gelatinoso y se encuentra debajo de la membrana plasmática. Los cazafantasmas medían su radiación",},
                    {answer: "Erizo",
                    question: "Pequeño mamífero insectívoro nocturno, con el dorso y los costados cubiertos de agudas púas, la cabeza pequeña, el hocico afilado y las patas y la cola muy cortas, que en caso de peligro se enrolla en forma de bola.",},
                    {answer: "ET",
                    question: "Película de 1982 en la que un extraterrestre quiere llamar a su casa.",},],
                   [{answer: "Facil",
                    question: "Que no requiere gran esfuerzo, capacidad o dificultad",},
                    {answer: "Elefante",
                    question: "Mamífero, el mayor de los animales terrestres, con cabeza y ojos pequeños, orejas grandes y colgantes, nariz y labio superior unidos y muy prolongados",},
                    {answer: "Finch",
                    question: "Película de 2021 en la que un ingeniero robótico, de nombre homónimo, y superviviente de un cataclismo solar, construye un robot para que cuide de su perro llegado el momento.",},],
                   [{answer: "Galaxia",
                    question: "Conjunto enorme de estrellas, polvo interestelar, gases y partículas",},
                    {answer: "Ganso",
                    question: "Ave palmípeda migratoria, semejante al pato pero de mayor tamaño, con plumaje básicamente gris, y pico y patas de color naranja, rosa o amarillo.",},
                    {answer: "Gattaca",
                    question: "Película de 1997 en la que en una sociedad futura impulsada por la eugenesia, Vincent Freeman, concebido fuera del programa de eugenesia, lucha por superar la discriminación genética y realizar su sueño de ir al espacio.",},],
                   [{answer: "Harakiri",
                    question: "Suicidio ritual japonés por desentrañamiento",},
                    {answer: "Hiena",
                    question: "Mamífero carnívoro, de pelaje áspero, gris amarillento, con manchas en el lomo y en los flancos, nocturno y principalmente carroñero.",},
                    {answer: "Her",
                    question: "Película de 2013 en la que Theodore se enamora de Samantha; una inteligencia artificial.",},],
                   [{answer: "Iglesia",
                    question: "Templo cristiano",},
                    {answer: "Gorila",
                    question: "Primate de pelaje oscuro y brazos más largos que las piernas, que puede alcanzar dos metros de alto.",},
                    {answer: "Interestellar",
                    question: "Película de 2014 en la que, para asegurar la supervivencia de la humanidad, Joseph Cooper, junto a su tripulación, a bordo de la Endurance deben adentrarse en un agujero de gusano y explorar planetas habitables cerca del agujero negro 'Gargantúa'.",},],
                   [{answer: "Jabali",
                    question: "Variedad salvaje del cerdo que sale en la película 'El Rey León', de nombre Pumba",},
                    {answer: "Jerbo",
                    question: "Mamífero roedor, de pelaje amarillento por encima y blanco por debajo, ojos grandes, cola larga, miembros anteriores muy cortos, y muy largos los posteriores, por lo cual, aunque suele caminar sobre las cuatro patas, salta mucho y con rapidez.",},
                    {answer: "Jumper",
                    question: "David Rice es un joven que tiene el misterioso poder de teletransportarse a cualquier lugar del mundo, saltando.",},],
                   [{answer: "Kamikaze",
                    question: "Persona que se juega la vida realizando una acción temeraria",},
                    {answer: "Kiwi",
                    question: "Ave apterigiforme, del tamaño de una gallina, que habita en Nueva Zelanda.",},
                    {answer: "Akira",
                    question: "Película de animación de 1988 ambientada en Tokio de 2019, ahora Neo-Tokio, 31 años después de la Tercera Guerra Mundial.",},],
                   [{answer: "Licantropo",
                    question: "Hombre lobo",},
                    {answer: "Lobo",
                    question: "Mamífero carnívoro con pelaje de color gris oscuro, hocico puntiagudo, orejas tiesas y cola larga y muy poblada, que vive salvaje, es gregario y puede atacar al ganado.",},
                    {answer: "Lucy",
                    question: "Película de 2014 en la que una joven, de nombre homónimo, es engañada y forzada a ser 'mula' de la droga CPH4. La droga se esparce por el interior de su cuerpo provocando en ella, entre otras consecuencias, un desarrollo exponencial de su capacidad cerebral.",},],
                   [{answer: "Misantropo",
                    question: "Persona que huye del trato con otras personas o siente gran aversión hacia ellas",},
                    {answer: "Mosca",
                    question: "Insecto muy común, de cuerpo negro, ojos salientes, alas transparentes cruzadas de nervios, patas largas con uñas y ventosas, y boca en forma de trompa, con la cual chupa las sustancias de que se alimenta.",},
                    {answer: "Moon",
                    question: "Película de 2009 en la que un astronauta, Sam Bell, vive aislado durante tres años en una excavación minera de la Luna. Cuando su contrato está a punto de expirar, descubre un terrible secreto que le concierne.",},],
                   [{answer: "Necedad",
                    question: "Demostración de poca inteligencia",},
                    {answer: "Navaja",
                    question: "Molusco marino cuya concha se compone de dos valvas simétricas, lisas, de color verdoso con visos blancos y azulados, de diez a doce centímetros de longitud y dos de anchura, cuya forma recuerda las cachas de un cuchillo.",},
                    {answer: "Tenet",
                    question: "Película de 2020 en la que todo gira en torno al espionaje internacional, los viajes en el tiempo y la evolución, en la que un agente secreto debe prevenir la Tercera Guerra Mundial.",},],
                   [{answer: "Señal",
                    question: "Indicio que permite deducir algo de lo que no se tiene un conocimiento directo.",},
                    {answer: "Ñu",
                    question: "Mamífero rumiante africano de la familia de los antílopes, de color pardo grisáceo, cuya cabeza recuerda la de un toro.",},
                    {answer: "Señales",
                    question: "Película de 2002 en la que Graham Hess, un ex sacerdote episcopal, descubre un misterioso círculo en su plantación de maíz.",},],
                   [{answer: "Orco",
                    question: "Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien",},
                    {answer: "Oso",
                    question: "Mamífero carnívoro, de gran tamaño, de pelaje pardo, largo y espeso, cabeza grande, ojos pequeños, extremidades fuertes y gruesas, con garras, y cola muy corta.",},
                    {answer: "Depredador",
                    question: "Película de 1987 en la que mercenarios son contratados por la CIA para rescatar a unos pilotos apresados por la guerrilla en la selva centroamericana. Al llegar se encuentran con cuerpos de soldados despellejados. Hay un peligro mucho más aterrador acechándoles.",},],
                   [{answer: "Protoss",
                    question: "Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft",},
                    {answer: "Puma",
                    question: "Felino americano de unos 180 cm de longitud, de color rojizo o leonado uniforme, que vive en serranías y llanuras.",},
                    {answer: "Pandorum",
                    question: "Película de 2009 en la que dos miembros de la Elysium se despiertan en sus cámaras de hibernación sin recordar nada. Aparentemente los únicos supervivientes. No sólo descubren la terrible desaparición del resto de tripulantes y pasajeros; no están solos.",},],
                   [{answer: "Queso",
                    question: "Producto obtenido por la maduración de la cuajada de la leche",},
                    {answer: "Arenque",
                    question: "Pez de unos 25 cm de longitud, cuerpo comprimido, boca pequeña, dientes visibles en las dos mandíbulas y color azulado por encima, plateado por el vientre, y con una raya dorada a lo largo del cuerpo en la época de la freza.",},
                    {answer: "Aniquilacion",
                    question: "Película de 2019 en la que Lena, bióloga y antigua soldado, se une a la misión que busca a su esposo, desaparecido en una región de acceso restringido. Mientras recorren el área, comprueban que está poblada por criaturas terroríficas, tan hermosas como mortíferas.",},],
                   [{answer: "Racimo",
                    question: "Conjunto de uvas sostenidas en un mismo tallo.",},
                    {answer: "Reno",
                    question: "Ciervo de los países septentrionales, con astas muy ramosas, tanto el macho como la hembra, y pelaje espeso, rojo parduzco en verano y rubio blanquecino en invierno. Se domestica con facilidad, sirve como animal de tiro para los trineos",},
                    {answer: "Rollerball",
                    question: "Película de 1975 en la que, en el año 2018, existe un juego, de nombre homónimo, que es la vía de escape para la rabia y frustraciones de las masas, este es el juego violento más popular del futuro.",},],
                   [{answer: "StackOverflow",
                    question: "Comunidad salvadora de todo desarrollador informático",},
                    {answer: "Serpiente",
                    question: "Reptil ofidio sin pies, de cuerpo aproximadamente cilíndrico y muy largo respecto de su grueso, cabeza aplanada, boca grande y piel pintada simétricamente con colores diversos, escamosa, y cuya epidermis muda por completo el animal de tiempo en tiempo.",},
                    {answer: "Sunshine",
                    question: "Película de 2007 en la que la nave Icarus II es la última esperanza de la humanidad para reactivar el Sol mediante una bomba nuclear del tamaño de la isla de Manhattan.",},],
                   [{answer: "Terminator",
                    question: "Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984",},
                    {answer: "Topo",
                    question: "Mamífero insectívoro del tamaño de un ratón, de cuerpo rechoncho, cola corta y pelaje negruzco suave y tupido, de hocico afilado, ojos diminutos y casi ocultos por el pelo, con fuertes uñas para socavar y apartar la tierra al abrir las galerías subterráneas donde vive.",},
                    {answer: "Tron",
                    question: "Película de 1982 en la que un programador de videojuegos de éxito se introduce en los circuitos de su ordenador donde los programas tienen vida propia.",},],
                   [{answer: "Unamuno",
                    question: "Escritor y filósofo español de la generación del 98 autor del libro 'Niebla' en 1914",},
                    {answer: "Urraca",
                    question: "Ave similar al cuervo, pero más pequeña, de plumaje negro y blanco, y con una cola más larga, que remeda palabras y suele llevarse al nido objetos pequeños, sobre todo si son brillantes.",},
                    {answer: "Ultravioleta",
                    question: "Película de 2006 en la que a finales del siglo XXI, un virus vampírico altera a algunas personas, otorgándoles una fuerza, inteligencia y velocidad sobrehumana. Una de las mutantes es asediada por proteger a un niño que es visto como una amenaza para la humanidad.",},],
                   [{answer: "Vikingos",
                    question: "Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa",},
                    {answer: "Vaca",
                    question: "Hembra del toro.",},
                    {answer: "Virtuosity",
                    question: "Película de 1995 en la que un asesino virtual, que forja su personalidad uniendo la de múltiples asesinos en serie, consigue salir al mundo real. Para lograr capturarlo deben sacar a un ex policía de la cárcel, que se había enfrentado con la principal personalidad del asesino.",},],
                   [{answer: "Botox",
                    question: "Toxina bacteriana utilizada en cirujía estética",},
                    {answer: "Xenopus",
                    question: "Rana carnívora procedente de África.",},
                    {answer: "Matrix",
                    question: "Película de 1999 en la que un programador informático, y conocido en el mundo de los 'hackers', está en el punto de mira del agente Smith. Otros dos piratas informáticos se ponen en contacto con él para ayudarlo a escapar. Sigue al conejo blanco.",},],
                   [{answer: "Peyote",
                    question: "Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal por indígenas americanos",},
                    {answer: "Coyote",
                    question: "Mamífero carnívoro de Norteamérica, semejante al lobo pero más pequeño y de pelaje gris amarillento.",},
                    {answer: "Gravity",
                    question: "Película de 2013 en la que la doctora Ryan Stone, ingeniera especializada en medicina, realiza su primera misión en un transbordador espacial, acompañada por Matt Kowalsky, un astronauta veterano. Al destruirse la nave, ambos quedaran atrapados en el espacio profundo.",},],
                   [{answer: "Zen",
                    question: "Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional",},
                    {answer: "Zorro",
                    question: "Mamífero cánido de menos de un metro de longitud, de hocico alargado y orejas empinadas, pelaje de color pardo rojizo y muy espeso, especialmente en la cola, de punta blanca. Suele ser nocturno.",},
                    {answer: "Brazil",
                    question: "Película de 1985 en la que en un futuro donde reinan las máquinas, un incidente informático provoca la detención y asesinato de un padre de familia. Sam Lowry es el encargado de devolver un talón a la familia de la víctima, hecho que le lleva a hacer amistad con el verdadero perseguido.",},],];

const letters = [{letter: 'a', bigCode: [0, 7, 22], type: 0},
                {letter: 'b', bigCode: [1, 8, 23], type: 0},
                {letter: 'c', bigCode: [2, 9, 24], type: 0},
                {letter: 'd', bigCode: [1, 10, 23], type: 1, frameCode: [[9, 4]]},
                {letter: 'e', bigCode: [3, 11, 25], type: 3, frameCode: [[1, 14], [9, 4]]},
                {letter: 'f', bigCode: [3, 11, 26], type: 2, frameCode: [[1, 14], [10, 9]]},
                {letter: 'g', bigCode: [2, 12, 24], type: 2, frameCode: [[10, 16]]},
                {letter: 'h', bigCode: [4, 8, 22], type: 2, frameCode: [[10, 6]]},
                {letter: 'i', bigCode: [3, 13, 25], type: 3, frameCode: [[7, 2]]},
                {letter: 'j', bigCode: [3, 14, 23], type: 3, frameCode: [[3, 13], [7, 2]]},
                {letter: 'k', bigCode: [4, 15, 22], type: 4, frameCode: [[3, 13]]},
                {letter: 'l', bigCode: [5, 16, 25], type: 0},
                {letter: 'm', bigCode: [4, 17, 22], type: 0},
                {letter: 'n', bigCode: [4, 18, 22], type: 0},
                {letter: 'ñ', bigCode: [6, 18, 22], type: 0},
                {letter: 'o', bigCode: [0, 10, 27], type: 0},
                {letter: 'p', bigCode: [1, 19, 26], type: 5, frameCode: [[1, 14]]},
                {letter: 'q', bigCode: [0, 10, 28], type: 3, frameCode: [[1, 14], [9, 4]]},
                {letter: 'r', bigCode: [1, 19, 22], type: 3, frameCode: [[9, 4]]},
                {letter: 's', bigCode: [2, 20, 23], type: 2, frameCode: [[10, 9]]},
                {letter: 't', bigCode: [3, 13, 27], type: 2, frameCode: [[10, 16]]},
                {letter: 'u', bigCode: [4, 10, 25], type: 2, frameCode: [[3, 13], [10, 6]]},
                {letter: 'v', bigCode: [4, 10, 27], type: 3, frameCode: [[3, 13], [7, 2]]},
                {letter: 'x', bigCode: [4, 13, 22], type: 6, frameCode: [[7, 2]]},
                {letter: 'y', bigCode: [4, 13, 27], type: 0},
                {letter: 'z', bigCode: [3, 21, 25], type: 0},];

const bigLetters = ['  ▄  ', ' ▄▄  ', '  ▄▄ ', ' ▄▄▄ ', ' ▄ ▄ ', ' ▄   ', ' ▄~▄ ',
                    ' █▄█ ', ' █■█ ', ' █   ', ' █ █ ', ' █■  ', ' █ ▄ ', '  █  ', ' ▄ █ ', ' █▀▄ ', ' █   ', ' █V█ ', ' █\\█ ', ' █▄▀ ', ' ▀■▄ ', ' ▄■▀ ',
                    ' ▀ ▀ ', ' ▀▀  ', '  ▀▀ ', ' ▀▀▀ ', ' ▀   ', '  ▀  ', '  ▀■ '];

const frame = ['       ', ' ▄▄▄▄▄ ', ' ▄▄▄▄█', '     █', '█▄▄▄▄ ', '█     ', ' ▄▄▄██▀▀▀ ', ' ▄▄▄▄▄    ', '    ▀▀▀▀▀ ', ' ▀▀▀██▄▄▄ ', ' ▀▀▀▀▀    ', '    ▄▄▄▄▄ ', '          ', '█▀▀▀▀ ', ' ▀▀▀▀█', ' ▀▀▀▀▀ ', ' █████ ', '█'];

const mainDisc = [{display: [frame[1], '█' + bigLetters[2] + '█', '█' + bigLetters[9] + '█', '█' + bigLetters[24] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[0] + '█', '█' + bigLetters[10] + '█', '█' + bigLetters[27] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[1] + '█', '█' + bigLetters[10] + '█', '█' + bigLetters[23] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[3] + '█', '█' + bigLetters[11] + '█', '█' + bigLetters[25] + frame[4]]},
                  {display: [frame[14] + bigLetters[1] + '█', '█' + bigLetters[19] + '█', '█' + bigLetters[22] + frame[4]]},
                  {display: [frame[14] + bigLetters[2] + '█', '█' + bigLetters[20] + '█', '█' + bigLetters[23] + '█', frame[10]]},
                  {display: [' ▄█▀█▄ ', ' █ █ █ ', ' ▀█▄█▀ ', '      ']},
                  {display: [' ▄▀█▀▄ ', ' ██ ██ ', ' ▀▄█▄▀ ', frame[7]]},
                  {display: ['█' + bigLetters[0] + '█', '█' + bigLetters[7] + '█', frame[2] + bigLetters[22] + '█']},
                  {display: ['█' + bigLetters[1] + frame[13], '█' + bigLetters[19] + '█', frame[2] + bigLetters[22] + '█']},
                  {display: ['█' + bigLetters[1] + frame[13], '█' + bigLetters[8] + '█', '█' + bigLetters[23] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[0] + '█', '█' + bigLetters[7] + '█', '█' + bigLetters[22] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[5] + '█', '█' + bigLetters[16] + '█', '█' + bigLetters[25] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[0] + '█', '█' + bigLetters[7] + '█', '█' + bigLetters[22] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[1] + '█', '█' + bigLetters[19] + '█', '█' + bigLetters[26] + '█', frame[15]]},
                  {display: [frame[1], '█' + bigLetters[0] + '█', '█' + bigLetters[7] + '█', '█' + bigLetters[22] + '█', frame[15]]},
                  {display: [frame[14] + bigLetters[2] + '█', '█' + bigLetters[20] + '█', '█' + bigLetters[23] + '█', frame[15]]},
                  {display: [frame[14] + bigLetters[0] + '█', '█' + bigLetters[7] + '█', '█' + bigLetters[22] + frame[4]]},
                  {display: ['█' + bigLetters[1] + '█', '█' + bigLetters[19] + '█', '█' + bigLetters[26] + frame[4]]},
                  {display: [' ▄█▀█▄ ', ' █ █ █ ', ' ▀█▄█▀ ', frame[11]]},
                  {display: [' ▄▀█▀▄ ', ' ██ ██ ', ' ▀▄█▄▀ ', '      ']},
                  {display: ['█' + bigLetters[3] + frame[13], '█' + bigLetters[13] + '█', '█' + bigLetters[25] + '█', frame[8]]},
                  {display: ['█' + bigLetters[2] + frame[13], '█' + bigLetters[20] + '█', frame[2] + bigLetters[23] + '█']},
                  {display: [frame[1], '█' + bigLetters[1] + '█', '█' + bigLetters[10] + '█', frame[2] + bigLetters[23] + '█']},
                  {display: [frame[1], '█' + bigLetters[3] + '█', '█' + bigLetters[13] + '█', '█' + bigLetters[25] + '█', frame[15]]},
                  {display: [frame[1], '█' + '     '+ '█', '█' + '     ' + '█', '█' + '     ' + '█', frame[15]]}]

let ranking = [{user: 'ManuR357', guess: 26, fails: 0},
               {user: 'Tony4', guess: 24, fails: 1},
               {user: 'R0s_4', guess: 17, fails: 6},
               {user: 'ISDI', guess: 18, fails: 2},
               {user: 'kmakus', guess: 22, fails: 2},
               {user: 'Awa954', guess: 15, fails: 4},
               {user: '3v1t4', guess: 12, fails: 4},
               {user: 'err0R!', guess: 0, fails: 26},
               {user: 'err0R!', guess: 0, fails: 26}]

getUserName = () => {
    let userName = prompt('\nNombre de Usuario: ');
    return (userName === null || userName === '' || userName === ' '.repeat(userName.length)) ? userName = 'Anónimo/a' : userName;
}

joinLetterProps = () => {
    let newLetters = [];
    questions.forEach((question, i) => {
        newLetters.push({...letters[i], ...question[Math.floor(Math.random() * 3)]});
        newLetters[i].status = 'active';
        setDisplayLetterProp(newLetters, i);
    });
    return newLetters;
}

setDisplayLetterProp = (array, i) => {
    let letter = array[i];
    
    const defaultFrame = () => letter.display = [frame[1], '█' + bigLetters[letter.bigCode[0]] + '█', '█' + bigLetters[letter.bigCode[1]] + '█', '█' + bigLetters[letter.bigCode[2]] + '█', frame[15]];

    const cutDisplay = () => {
        if (letter.type === 0) {return;}
        if ([1, 3, 6].includes(letter.type)) {letter.display.pop();}
        if ([2, 3, 4, 5].includes(letter.type)) {letter.display.shift();}
    }

    const fixFrame = (setLayout = false) => {
        if (letter.status === 'active') {
            defaultFrame();
            if (!letter.frameCode) {return;}
            letter.frameCode.forEach((framePosition) => {
                if (framePosition[0] === 1) {letter.display[1] = frame[framePosition[1]] + bigLetters[letter.bigCode[0]] + '█';}
                if (framePosition[0] === 3) {letter.display[1] = '█' + bigLetters[letter.bigCode[0]] + frame[framePosition[1]];}
                if (framePosition[0] === 7) {letter.display[3] = frame[framePosition[1]] + bigLetters[letter.bigCode[2]] + '█';}
                if (framePosition[0] === 9) {letter.display[3] = '█' + bigLetters[letter.bigCode[2]] + frame[framePosition[1]];}
                if (framePosition[0] === 10) {letter.display[4] = frame[framePosition[1]];}
            });
        }
        if (!setLayout) {
            if (letter.letter === 'd') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[3] = letter.display[3].slice(0, 7);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[3] = letter.display[3].slice(0, -1) + frame[1].slice(1);}}
            if (letter.letter === 'f') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[1] = frame[3] + letter.display[1].slice(6);}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[1] = frame[15].slice(0, -1) + letter.display[1].slice(1);}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[1] = '     ' + letter.display[1];}
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[10];}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[4] = frame[11];}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[12];}}
            if (letter.letter === 'g') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[15];}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[4] = frame[1];}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[0];}}
            if (letter.letter === 'h') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[8];}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[4] = frame[7];}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[4] = frame[12];}}
            if (letter.letter === 's') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[10];}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[4] = frame[11];}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[12];}}
            if (letter.letter === 't') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[15];}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[4] = frame[1];}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[0];}}
            if (letter.letter === 'u') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[1] = letter.display[1].slice(0, -1) + frame[15].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[8];}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[4] = frame[7];}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[4] = frame[12]}}
            if (letter.letter === 'e') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[1] = frame[3] + letter.display[1].slice(6);}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[1] = frame[15].slice(0, -1) + letter.display[1].slice(1);}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[1] = '     ' + letter.display[1];}
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[3] = letter.display[3].slice(0, 7);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[3] = letter.display[3].slice(0, -1) + frame[1].slice(1);}}
            if (letter.letter === 'i') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[3] = frame[3] + letter.display[3].slice(6);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[3] = frame[1].slice(0, -1) + letter.display[3].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[3] = '     ' + letter.display[3];}}
            if (letter.letter === 'j') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[1] = letter.display[1].slice(0, -1) + frame[15].slice(1);}
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[3] = frame[3] + letter.display[3].slice(6);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[3] = frame[1].slice(0, -1) + letter.display[3].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[3] = '     ' + letter.display[3];}}
            if (letter.letter === 'q') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[1] = frame[3] + letter.display[1].slice(6);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[1] = frame[15].slice(0, -1) + letter.display[1].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[1] = '     ' + letter.display[1];}
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[3] = letter.display[3].slice(0, 6) + frame[5];}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[3] = letter.display[3].slice(0, -1) + frame[1].slice(1);}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[3] = letter.display[3] + '     ';}}
            if (letter.letter === 'r') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[3] = letter.display[3].slice(0, 6) + frame[5];}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[3] = letter.display[3].slice(0, -1) + frame[1].slice(1);}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[3] = letter.display[3] + '     ';}}
            if (letter.letter === 'v') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[1] = letter.display[1].slice(0, -1) + frame[15].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[3] = frame[3] + letter.display[3].slice(6);}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[3] = frame[1].slice(0, -1) + letter.display[3].slice(1);}
                if (letter.status != 'active' && array[i - 1].status != 'active') {letter.display[3] = '     ' + letter.display[3];}}
            if (letter.letter === 'k') {
                if (letter.status === 'active' && array[i - 1].status != 'active') {letter.display[1] = letter.display[1].slice(0, 7) + '     ';}
                if (letter.status != 'active' && array[i - 1].status === 'active') {letter.display[1] = letter.display[1].slice(0, -1) + frame[15].slice(1);}}
            if (letter.letter === 'p') {
                if (letter.status === 'active' && array[i + 1].status != 'active') {letter.display[1] = frame[3] + letter.display[1].slice(6);}
                if (letter.status != 'active' && array[i + 1].status === 'active') {letter.display[1] = frame[15].slice(0, -1) + letter.display[1].slice(1);}
                if (letter.status != 'active' && array[i + 1].status != 'active') {letter.display[1] = '     ' + letter.display[1];}}
            if (letter.letter === 'x') {
                if (array[i].status === 'active' && array[i - 1].status != 'active') {letter.display[3] = '     ' + letter.display[3].slice(5);}
                if (array[i].status != 'active' && array[i - 1].status === 'active') {letter.display[3] = frame[1].slice(0, -1) + letter.display[3].slice(1);}
                if (array[i].status != 'active' && array[i - 1].status != 'active') {letter.display[3] = '     ' + letter.display[3];}}
        }
    }
    if (letter.status === 'active') {
        !letter.display ? fixFrame(true) : fixFrame();
    }
    if (letter.status != 'active') {
        let newStatus = letter.status === 'guess' ? [' ▄█▀█▄ ', ' █ █ █ ', ' ▀█▄█▀ '] : [' ▄▀█▀▄ ', ' ██ ██ ', ' ▀▄█▄▀ '];
        letter.display = [frame[0], newStatus[0], newStatus[1], newStatus[2], frame[0]]
        fixFrame();
    }
    cutDisplay();
}

checkLetterStatusAndFrame = (array) => {
    for (let i = 0; i < array.length; i++) {
        setDisplayLetterProp(array, i);
    };
}

repeatChar = (n, char = ' ') => char.repeat(n);

logo = (mode = true) => {
    const logo = [repeatChar(21),
                  `${repeatChar(14)}▄▄▄ ▄▄▄${repeatChar(14)}`,
                  `${repeatChar(12)}▄ ▄█▄ ▄■■ ▄${repeatChar(12)}`,
                  `${repeatChar(16)}▀▄ ▄▄  ▄▄▄ ▄▀${repeatChar(16)}`,
                  `${repeatChar(19)}█▄▀ ▄█▄${repeatChar(19)}`,
                  repeatChar(45)];
    const emptyLogo = [repeatChar(21), repeatChar(35), repeatChar(35), repeatChar(45), repeatChar(45), repeatChar(45)];
    return mode ? logo : emptyLogo;
}

menuScreen = (userName) => {
    let screen = [' ┌' + repeatChar(51, '─') + '┐ ',
                  ' │' + repeatChar(51) + '│ ',
                  ' │' + repeatChar(51) + '│ ',
                  '    │' + '    [1] ¡JUGAR!' + repeatChar(36) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + '    [2] Cambiar nombre (' + userName + ')' + repeatChar(26 - userName.length) + '│    ',
                  '     │' + repeatChar(51) + '│',
                  '    │' + '    [3] Ver puntuaciones' + repeatChar(27) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + '    [4] Salir' + repeatChar(38) + '│    ',
                  ' │' + repeatChar(51) + '│ ',
                  ' │' + repeatChar(51) + '│ ',
                  ' └' + repeatChar(51, '─') + '┘ '];
    return screen;
}

rankingScreen = () => {
    ranking.sort((a, b) => b.guess - a.guess);
    const guessAndFailBar = (objProp) => objProp % 2 === 0 ? repeatChar(objProp / 2, '■') + repeatChar(13 - objProp / 2) : repeatChar((objProp - 1) / 2, '■') + repeatChar(13 - (objProp - 1) / 2)
    let rankingFormatted = ranking.map(position => {
        return `${position.user + repeatChar(14 - position.user.length)}= O[${guessAndFailBar(position.guess)}] X[${guessAndFailBar(position.fails)}] `;
    });

    let screen = [' ┌' + repeatChar(51, '─') + '┐ ',
                  ' │' + repeatChar(18) + 'TOP 10 RANKING' + repeatChar(19) + '│ ',
                  ' ├' + repeatChar(51, '─') + '┤ ',
                  '    │ ' + rankingFormatted[0] + '│    ',
                  '    │ ' + rankingFormatted[1] + '│    ',
                  '    │ ' + rankingFormatted[2] + '│    ',
                  '     │ ' + rankingFormatted[3] + '│    ',
                  '    │ ' + rankingFormatted[4] + '│    ',
                  '    │ ' + rankingFormatted[5] + '│    ',
                  '    │ ' + rankingFormatted[6] + '│    ',
                  ' │ ' + rankingFormatted[7] + '│ ',
                  ' │ ' + rankingFormatted[8] + '│ ',
                  ' └' + repeatChar(51, '─') + '┘ '];
    return screen;         
}

questionScreen = (letter) => {
    let introLetter = letter.answer.slice(0, 1) === letter.letter.toUpperCase() ? '   CON LA ' + letter.letter.toUpperCase() + '  ' : 'CONTIENE LA ' + letter.letter.toUpperCase();
    const questionFormatter = () => {
        let questionRowFormat = [''];
        let row = 0;
        let questionWords = letter.question.split(' ');
        for (let word of questionWords) {
            if (questionRowFormat[row].length + word.length < 49) {
                questionRowFormat[row] = questionRowFormat[row].concat(word + ' ');
            }
            else {
                questionRowFormat.push(word + ' ');
                row++;
            }
        }
        questionRowFormat = questionRowFormat.map(row => row += ' '.repeat(50 - row.length));
        for (let i = questionRowFormat.length; i < 9; i++) {questionRowFormat.push(' '.repeat(50))}
        return questionRowFormat;
    }
    
    let questionFormatted = questionFormatter();
    let screen = [' ┌' + repeatChar(51, '─') + '┐ ',
                  ' │' + repeatChar(19) + introLetter + repeatChar(19) + '│ ',
                  ' ├' + repeatChar(51, '─') + '┤ ',
                  '    │ ' + questionFormatted[0] + '│    ',
                  '    │ ' + questionFormatted[1] + '│    ',
                  '    │ ' + questionFormatted[2] + '│    ',
                  '    │ ' + questionFormatted[3] + '│    ',
                  '    │ ' + questionFormatted[4] + '│    ',
                  '    │ ' + questionFormatted[5] + '│    ',
                  '    │ ' + questionFormatted[6] + '│    ',
                  ' │ ' + questionFormatted[7] + '│ ',
                  ' │ ' + questionFormatted[8] + '│ ',
                  ' └' + repeatChar(51, '─') + '┘ '];
    return screen;
}

byeScreen = (user) => {
    let screen = [' ┌' + repeatChar(51, '─') + '┐ ',
                  ' │' + repeatChar(51) + '│ ',
                  ' │' + repeatChar(51) + '│ ',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  '     │' + repeatChar(11) + '¡Hasta la próxima, ' + user + '!' + repeatChar(20 - user.length) + '│',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  '    │' + repeatChar(51) + '│    ',
                  ' │' + repeatChar(51) + '│ ',
                  ' │' + repeatChar(51) + '│ ',
                  ' └' + repeatChar(51, '─') + '┘ '];
    return screen;
}

layout = (array, logoArray, screen) => {
    console.clear();
    const emptySpace = logo(false).sort((a, b) => -1);

    const layout = ['\n\n\n' + repeatChar(28) + array[25].display[0] + array[0].display[0] + array[1].display[0],
                  repeatChar(21) + array[24].display[0] + array[25].display[1] + array[0].display[1] + array[1].display[1] + array[2].display[0],
                  repeatChar(21) + array[24].display[1] + array[25].display[2] + array[0].display[2] + array[1].display[2] + array[2].display[1],
                  repeatChar(14) + array[23].display[0] + array[24].display[2] + array[25].display[3] + array[0].display[3] + array[1].display[3] + array[2].display[2] + array[3].display[0],
                  repeatChar(14) + array[23].display[1] + array[24].display[3] + array[25].display[4] + array[0].display[4] + array[1].display[4] + array[2].display[3] + array[3].display[1],
                  repeatChar(14) + array[23].display[2] + array[24].display[4] + logoArray[0] + array[2].display[4] + array[3].display[2],
                  repeatChar(9) + array[23].display[3] + logoArray[1] + array[3].display[3],
                  repeatChar(9) + array[22].display[0] + logoArray[2] + array[4].display[0],
                  repeatChar(9) + array[22].display[1] + logoArray[3] + array[4].display[1],
                  repeatChar(4) + array[22].display[2] + logoArray[4] + array[4].display[2],
                  repeatChar(4) + array[21].display[0] + logoArray[5] + array[5].display[0],
                  repeatChar(4) + array[21].display[1] + screen[0] + array[5].display[1],
                  repeatChar(4) + array[21].display[2] + screen[1] + array[5].display[2],
                  repeatChar(1) + array[21].display[3] + screen[2] + array[5].display[3],
                  repeatChar(1) + array[20].display[0] + screen[3] + array[6].display[0],
                  repeatChar(1) + array[20].display[1] + screen[4] + array[6].display[1],
                  repeatChar(1) + array[20].display[2] + screen[5] + array[6].display[2],
                  repeatChar(1) + array[20].display[3] + screen[6] + array[6].display[3],
                  repeatChar(1) + array[19].display[0] + screen[7] + array[7].display[0],
                  repeatChar(1) + array[19].display[1] + screen[8] + array[7].display[1],
                  repeatChar(1) + array[19].display[2] + screen[9] + array[7].display[2],
                  repeatChar(1) + array[19].display[3] + screen[10] + array[7].display[3],
                  repeatChar(4) + array[18].display[0] + screen[11] + array[8].display[0],
                  repeatChar(4) + array[18].display[1] + screen[12] + array[8].display[1],
                  repeatChar(4) + array[18].display[2] + emptySpace[0] + array[8].display[2],
                  repeatChar(4) + array[17].display[0] + emptySpace[1] + array[9].display[0],
                  repeatChar(9) + array[17].display[1] + emptySpace[2] + array[9].display[1],
                  repeatChar(9) + array[17].display[2] + emptySpace[3] + array[9].display[2],
                  repeatChar(9) + array[16].display[0] + emptySpace[4] + array[10].display[0],
                  repeatChar(14) + array[16].display[1] + array[15].display[0] + emptySpace[5] + array[11].display[0] + array[10].display[1],
                  repeatChar(14) + array[16].display[2] + array[15].display[1] + array[14].display[0] + array[13].display[0] + array[12].display[0] + array[11].display[1] + array[10].display[2],
                  repeatChar(14) + array[16].display[3] + array[15].display[2] + array[14].display[1] + array[13].display[1] + array[12].display[1] + array[11].display[2] + array[10].display[3],
                  repeatChar(21) + array[15].display[3] + array[14].display[2] + array[13].display[2] + array[12].display[2] + array[11].display[3],
                  repeatChar(21) + array[15].display[4] + array[14].display[3] + array[13].display[3] + array[12].display[3] + array[11].display[4],
                  repeatChar(28) + array[14].display[4] + array[13].display[4] + array[12].display[4],];
    console.log(layout.join('\n'));
}

timeComparator = (start) => {
    timeToCompare = new Date();
    return (Math.floor(timeToCompare.getTime()/1000) - Math.floor(start.getTime()/1000)) >= 120 ? true : false;
}

addRanking = (letters, user) => {
    let newScore = {user: user, guess: 0, fails: 0};
    letters.forEach(letter =>{
        if (letter.status === 'guess') {newScore.guess++;}
        if (letter.status === 'fail') {newScore.fails++;}
    })
    ranking.push(newScore)
    ranking.sort((a, b) => b.guess - a.guess);
}

game = (lettersCurrentGame, user) => {
    let timeStart = new Date();
    let flag = true;
    while (flag) {
        lettersCurrentGame.forEach(letter => {
            if (timeComparator(timeStart) || lettersCurrentGame.every(letter => letter.status != 'active')) {
                addRanking(lettersCurrentGame, user);
                flag = false;
            }
            if (!flag) {return;}
            layout(lettersCurrentGame, logo(), questionScreen(letter));
            let userAnswer = prompt('¿Respuesta?\n\nPasapalabra = Siguiente pregunta\nEnd = Salir');
            if (userAnswer != null) {userAnswer = userAnswer.toLowerCase()}
            switch (userAnswer) {
                case 'end':
                    flag = false;
                    break;
                case 'pasapalabra':
                    break;
                case letter.answer.toLowerCase():
                    letter.status = 'guess';
                    break;
                default:
                    letter.status = 'fail';
            }
            checkLetterStatusAndFrame(lettersCurrentGame);
            layout(lettersCurrentGame, logo(), questionScreen(letter));
        });
    }
    layout(mainDisc, logo(false), rankingScreen());
    alert('Volver al menú');
    return;
}

main = () => {
    let userName = getUserName();
    while (true) {
        layout(mainDisc, logo(false), menuScreen(userName));
        switch (+prompt('Opción:')) {
            case 1:
                game(joinLetterProps(), userName);
                break;
            case 2:
                userName = getUserName();
                break;
            case 3:
                layout(mainDisc, logo(false), rankingScreen());
                alert('Volver al menú');
                break;
            case 4:
                layout(mainDisc, logo(false), byeScreen(userName));
                return;
        }
    }
}

main();